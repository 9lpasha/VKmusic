<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="files/main.css">
    <title>Player</title>
    <script src="files/jquery.js"></script>
    <script>
    </script>
</head>
<body>
<audio preload="true" style="display: none" id="player" crossorigin controls></audio>
<video preload="true" style="display: none" id="video" controls autoplay playsinline></video>
<div class="wrapper">
    <div class="header_wrapper">
        <div class="header"><a href="/">
            <div class="back">Новинки</div>
        </a>
            <div class="tab" style="display: none;">Новинки</div>
            <div class="menu">
                <ul><a href="/">
                    <li class="music">Музыка ВКонтакте</li>
                </a><a href="/audios420202997">
                    <li class="">
                        <div class="image image_camera24" style="background-size: 16px;"></div>
                        Юлия Князева
                    </li>
                </a><a href="/fave">
                    <li class="fave">Избранное</li>
                </a><a href="/write">
                    <li class="write">Напишите нам</li>
                </a><a href="/about">
                    <li class="about">О сервисе</li>
                </a></ul>
            </div>
            <a href="/settings" class="settings"></a></div>
    </div>
    <div class="section_wrapper">
        <div class="search"><input type="text" placeholder="Поиск" value="">
            <div class="close" style="display: none;"></div>
        </div>
        <div class="spinner"></div>
        <div class="content">
            <div class="audios"></div>
        </div>
    </div>
    <div class="footer_player_wrapper" style="display: none">
        <div class="footer_player">
            <div class="footer_play"></div>
            <div class="audio_info">
                <div class="audio_title"></div>
                <div class="audio_author"></div>
            </div>
            <div class="footer_close"></div>
        </div>
    </div>
    <div class="popup_player_wrapper">
        <div class="popup_player_content">
            <div class="cover"></div>
            <div class="info">
                <div class="title"></div>
                <div class="author"></div>
            </div>
            <div class="progress_wrap">
                <div class="progress_seek"></div>
                <div class="progress_played"></div>
                <div class="progress_buffered"></div>
                <div class="progress_transition_circle"></div>
            </div>
            <div class="durations_wrap">
                <div class="duration_start"></div>
                <div class="duration_end"></div>
            </div>
            <div class="buttons_wrap">
                <div class="prev"></div>
                <div class="play"></div>
                <div class="next"></div>
            </div>
            <div class="button_bottom_wrap">
                <div class="shuffle"></div>
                <div class="repeat"></div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/hls.js/latest/hls.js"></script>
<script>
    $(document).ready(function () {
        const isTouch = () => 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch || navigator.maxTouchPoints > 0 || window.navigator.msMaxTouchPoints > 0

        document.addEventListener('mousedown', (e) => {
            if (isTouch()) {
                console.log('t111111tttttttttttttttttt - click');
            } else console.log('ttttttttttttttttttt - click');
        });
    });
</script>
<script>

    let secToMin = (a) => {
        let res
        parseInt(a / 60) > 9 ? res = parseInt(a / 60) + ':' : res = parseInt(a / 60) + ':'
        parseInt(a % 60) > 9 ? res += parseInt(a % 60) : res += '0' + parseInt(a % 60)
        if (!res.includes('NaN'))
            return res
    }

    let curTrack
    let curTrackId
    let curTrackRow
    let playing = 0
    let intCurTime
    let intCurTime2
    let audio = document.querySelector('#player');
    let video = document.querySelector('#video');
    let num_data_levels = 0
    let ifIntervalOne = 0
    let shuffle = 0
    let repeat = 0
    window.progressOrNot1 = 0
    window.progressOrNot2 = 0


    let xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            let myObj = JSON.parse(this.responseText);
            myObj.forEach((el) => {
                let audios = document.querySelector('.audios')
                audios.innerHTML += `
        <div class="audio">
            <div class="cover" style="background: url('${el.album.thumb.photo_68}') center / cover no-repeat;">
                <div class="play" data=""></div>
            </div>
            <span class="src_track" style="display: none">${el.url}</span>
            <span class="id_track" style="display: none">${el.id}</span>
            <div class="info">
                <div class="title">${el.title} <span class="author author_rightfromtitle" style="display: none"> - ${el.artist}</span></div>
            </div>
            <div class="player_wrapper" style="display: none">
                <div class="progress_wrap">
                    <div class="progress_seek"></div>
                    <div class="progress_played"></div>
                    <div class="progress_buffered"></div>
                    <div class="progress_transition"></div>
                </div>
                <div class="volume_wrap">
                    <div class="volume_display"></div>
                    <div class="volume_value"></div>
                    <div class="volume_transition"></div>
                </div>
            </div>
            <div class="author">${el.artist}</div>
            <div class="duration" data="${el.duration}">${secToMin(el.duration)}</div>
            <div class="download"></div>
        </div>
                `
            })
            //document.querySelectorAll('div').forEach((el)=>{el.draggable = true})
            let inputDataTrack
            if (localStorage.getItem('curTrack')) {
                document.querySelector('.footer_player_wrapper').style.display = 'block'
                inputDataTrack = JSON.parse(localStorage.getItem('curTrack'))
                document.querySelector('.footer_player .audio_title').textContent = inputDataTrack.title
                document.querySelector('.footer_player .audio_author').textContent = inputDataTrack.artist
                document.querySelector('.popup_player_content .title').textContent = inputDataTrack.title
                document.querySelector('.popup_player_content .author').textContent = inputDataTrack.artist
                document.querySelector('.popup_player_content .cover').style.background = `url('${inputDataTrack.album.thumb.photo_68}') center / cover no-repeat`
                document.querySelector('.popup_player_content .duration_end').textContent = `-${secToMin(inputDataTrack.duration)}`
                document.querySelector('.popup_player_content .duration_start').textContent = '0:00'
                curTrackRow = [...document.querySelectorAll('.audio')].filter((el) => el.querySelector('.id_track').innerText == inputDataTrack.id)[0]
                //document.querySelector('audio').volume = localStorage.getItem('volume')
                if (localStorage.getItem('volume')) {
                    document.querySelectorAll('.volume_transition').forEach((el) => el.style.left = localStorage.getItem('volume') * 100 + '%')
                    document.querySelectorAll('.volume_value').forEach((el) => el.style.width = localStorage.getItem('volume') * 100 + '%')
                } else {
                    document.querySelectorAll('.volume_transition').forEach((el) => el.style.left = 75 + '%')
                    document.querySelectorAll('.volume_value').forEach((el) => el.style.width = 75 + '%')
                    localStorage.setItem('volume', 0.75)
                }
                curTrackRow.querySelectorAll('.audio .author').forEach((el) => {
                    el.style.display = 'none'
                })
                window.onmousedown = (e) => {
                    e.preventDefault()
                    const withinBoundaries1 = e.composedPath().includes(curTrackRow.querySelector('.progress_wrap'));
                    const withinBoundaries2 = e.composedPath().includes(curTrackRow.querySelector('.volume_wrap'));
                    console.log(withinBoundaries1, withinBoundaries2)
                    if (!withinBoundaries1 && !withinBoundaries2) {
                        progressOrNot1 = 1
                    } else
                        progressOrNot1 = 0
                }
                window.onmouseup = (e) => {
                    const withinBoundaries1 = e.composedPath().includes(curTrackRow.querySelector('.progress_wrap'));
                    const withinBoundaries2 = e.composedPath().includes(curTrackRow.querySelector('.volume_wrap'));
                    console.log(withinBoundaries1, withinBoundaries2)
                    if (!withinBoundaries1 && !withinBoundaries2) {
                        progressOrNot2 = 1
                    } else
                        progressOrNot2 = 0
                }


                let inprogressbar = 0
                let dragrrogress = (e) => {
                    console.log(e)
                    let r = (e.clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                    if (r < 0) {
                        localStorage.setItem('volume', 0)
                    } else if (r > 1) {
                        localStorage.setItem('volume', 1)
                    } else {
                        localStorage.setItem('volume', r)
                    }
                }
                let dragrrogress2 = (e) => {
                    console.log(e)
                    let r = (e.changedTouches[0].clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                    if (r < 0) {
                        localStorage.setItem('volume', 0)
                    } else if (r > 1) {
                        localStorage.setItem('volume', 1)
                    } else {
                        localStorage.setItem('volume', r)
                    }
                }
                curTrackRow.querySelector('.volume_wrap').addEventListener('mousedown', (e) => {
                    inprogressbar = 1
                    document.querySelectorAll('.volume_value').forEach((el) => {
                        if (Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                            el.style.width = Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                    })
                    document.querySelectorAll('.volume_transition').forEach((el) => {
                        if (Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                            el.style.left = Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                    })
                    progressOrNot1 = 1
                    let r = (e.clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                    localStorage.setItem('volume', r)
                })

                window.addEventListener('mousemove', (e) => {
                    if (inprogressbar == 1) {
                        document.querySelectorAll('.volume_value').forEach((el) => {
                            if (Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                el.style.width = Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                        })
                        document.querySelectorAll('.volume_transition').forEach((el) => {
                            if (Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                el.style.left = Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                        })
                        let r = (e.clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                        if (r < 0) {
                            localStorage.setItem('volume', 0)
                        } else if (r > 1) {
                            localStorage.setItem('volume', 1)
                        } else {
                            localStorage.setItem('volume', r)
                        }
                    }
                })
                window.addEventListener('mouseup', (e) => {
                    if (inprogressbar == 1) {
                        dragrrogress(e)
                    }
                    inprogressbar = 0
                    console.log('0 0')
                })
                window.addEventListener('touchstart', (e) => {
                    if (e.composedPath().includes(curTrackRow.querySelector('.volume_wrap'))) {
                        console.log('nibjk')
                        inprogressbar = 1
                        document.querySelectorAll('.volume_value').forEach((el) => {
                            if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                el.style.width = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                        })
                        document.querySelectorAll('.volume_transition').forEach((el) => {
                            if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                el.style.left = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                        })
                        progressOrNot1 = 1
                        let r = (e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                        console.log(r)
                        localStorage.setItem('volume', r)
                    }
                })

                window.addEventListener('touchmove', (e) => {
                    if (inprogressbar == 1 && e.composedPath().includes(curTrackRow.querySelector('.volume_wrap'))) {
                        document.querySelectorAll('.volume_value').forEach((el) => {
                            if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                el.style.width = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                        })
                        document.querySelectorAll('.volume_transition').forEach((el) => {
                            if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                el.style.left = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                        })
                        let r = (e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                        console.log(r)
                        if (r < 0) {
                            localStorage.setItem('volume', 0)
                        } else if (r > 1) {
                            localStorage.setItem('volume', 1)
                        } else {
                            localStorage.setItem('volume', r)
                        }
                    }
                })
                window.addEventListener('touchend', (e) => {
                    if (e.composedPath().includes(curTrackRow.querySelector('.volume_wrap'))) {
                        if (inprogressbar == 1) {
                            dragrrogress2(e)
                        }
                        inprogressbar = 0
                        console.log('0 0')
                    }
                })


                curTrackRow.querySelectorAll('.audio .author_rightfromtitle').forEach((el) => {
                    el.style.display = 'inline-block'
                })
                curTrackRow.querySelector('.player_wrapper').style.display = 'flex'
                curTrackRow.querySelector('.progress_played').style.width = 0 + '%'
                curTrackRow.querySelector('.progress_transition').style.left = 0 + '%'
                document.querySelector('.popup_player_content .progress_played').style.width = 0 + '%'
                document.querySelector('.popup_player_content .progress_transition_circle').style.left = 0 + '%'
                document.querySelectorAll('.volume_value').forEach((el) => el.style.width = localStorage.getItem('volume') * 100 + '%')
                document.querySelectorAll('.volume_transition').forEach((el) => el.style.left = localStorage.getItem('volume') * 100 + '%')
                if (localStorage.getItem('shuffle'))
                    shuffle = localStorage.getItem('shuffle')
                if (localStorage.getItem('repeat'))
                    repeat = localStorage.getItem('repeat')
                if (shuffle == 1) {
                    document.querySelector('.shuffle').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%232688eb%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M19.5%205.26a.5.5%200%2001.3.1l2.93%202.24a.5.5%200%20010%20.8l-2.92%202.23a.5.5%200%2001-.81-.4V9h-3.5c-.9%200-1.7.76-3.28%203%201.57%202.24%202.39%203%203.28%203H19v-1.23a.5.5%200%2001.8-.4l2.93%202.23a.5.5%200%20010%20.8l-2.92%202.23a.5.5%200%2001-.81-.4V17h-3.5c-1.7%200-2.75-.84-4.5-3.26C9.25%2016.16%208.2%2017%206.5%2017H4a1%201%200%20010-2h2.5c.9%200%201.7-.76%203.28-3C8.21%209.76%207.4%209%206.5%209H4a1%201%200%20110-2h2.5c1.7%200%202.75.84%204.5%203.26C12.75%207.84%2013.8%207%2015.5%207H19V5.77c0-.28.22-.5.5-.5z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
                }
                if (repeat == 0) {
                    document.querySelector('.repeat').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%2399a2ad%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M20.5%2012a1%201%200%20011%201c0%203.05-1.95%205-5%205H9.02v1.75c0%20.26-.14.35-.33.24l-.06-.04-3.47-2.65c-.21-.16-.22-.43%200-.6l3.47-2.65c.2-.16.39-.08.39.2V16h7.48c1.88%200%202.92-.98%203-2.8V13a1%201%200%20011-1zm-5.1-7.95l3.46%202.65c.21.17.2.44%200%20.6l-3.47%202.65c-.21.17-.39.08-.39-.2V8H7.5c-1.88%200-2.92.98-3%202.8v.2a1%201%200%2001-2%200c0-3.05%201.95-5%205-5H15V4.25c0-.28.18-.36.4-.2z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
                } else if (repeat == 1) {
                    document.querySelector('.repeat').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%232688eb%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M20.5%2012a1%201%200%20011%201c0%203.05-1.95%205-5%205H9.02v1.75c0%20.26-.14.35-.33.24l-.06-.04-3.47-2.65c-.21-.16-.22-.43%200-.6l3.47-2.65c.2-.16.39-.08.39.2V16h7.48c1.88%200%202.92-.98%203-2.8V13a1%201%200%20011-1zm-5.1-7.95l3.46%202.65c.21.17.2.44%200%20.6l-3.47%202.65c-.21.17-.39.08-.39-.2V8H7.5c-1.88%200-2.92.98-3%202.8v.2a1%201%200%2001-2%200c0-3.05%201.95-5%205-5H15V4.25c0-.28.18-.36.4-.2z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
                } else {
                    document.querySelector('.repeat').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%232688eb%22%20fill%3D%22none%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22currentColor%22%3E%3Cpath%20clip-rule%3D%22evenodd%22%20d%3D%22m12.4754%209.13192c.2663.1638.4285.45396.4285.76649v4.20209c0%20.4971-.4031.9-.9003.9-.4973%200-.9004-.4029-.9004-.9v-2.7396c-.4428.2197-.9807.0412-1.20382-.4007-.22408-.4437-.04589-.98497.39802-1.20897l1.3004-.65625c.2791-.14084.6114-.12686.8776.03694z%22%20fill-rule%3D%22evenodd%22%2F%3E%3Cpath%20d%3D%22m2.00464%2012c0-3.25844%202.64246-5.89996%205.9021-5.89996h10.02596l-.5638-.56364c-.3516-.35148-.3516-.92132%200-1.2728.3516-.35147.9216-.35147%201.2732%200l2.1008%202.09998c.3516.35147.3516.92132%200%201.27279l-2.1008%202.09998c-.3516.35145-.9216.35145-1.2732%200-.3516-.35147-.3516-.92132%200-1.2728l.5637-.56351h-10.02586c-2.26517%200-4.10146%201.83563-4.10146%204.09996v.0967c0%20.4971-.40309.9-.90032.9s-.90032-.4029-.90032-.9z%22%2F%3E%3Cpath%20d%3D%22m21.1043%2011.0033c.4973%200%20.9003.403.9003.9v.0967c0%203.2585-2.6424%205.9-5.9021%205.9h-10.02836l.56372.5636c.35159.3514.35159.9213%200%201.2727-.3516.3515-.92165.3515-1.27325%200l-2.10072-2.0999c-.3516-.3515-.3516-.9213%200-1.2728l2.10072-2.1c.3516-.3515.92165-.3515%201.27325%200%20.35159.3515.35159.9213%200%201.2728l-.56384.5636h10.02848c2.2652%200%204.1015-1.8356%204.1015-4.1v-.0967c0-.497.4031-.9.9003-.9z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
                }
            }


            document.onkeydown = function iziz(iz) {
                if (iz.keyCode == '32') {
                    curTrackRow.children[0].click()
                }
            };


            document.querySelectorAll('.audio').forEach((el) => {
                el.onclick = (e) => {
                    console.log(playing)
                    const withinBoundaries1 = e.composedPath().includes(el.querySelector('.progress_wrap'));
                    const withinBoundaries2 = e.composedPath().includes(el.querySelector('.volume_wrap'));
                    let u = e.target
                    while (!u.classList.contains('audio'))
                        u = u.parentNode
                    curTrackRow = u
                    console.log(curTrackRow)
                    let playingFirst = 0
                    console.log(curTrack)
                    if (!withinBoundaries1 && !withinBoundaries2) {
                        if (curTrack && curTrack.substr(0, curTrack.length - 6) == curTrackRow.innerText.substr(0, curTrackRow.innerText.length - 6)) {
                            console.log(playing, '  -  playing')
                            if (playing == 1 && (!(!progressOrNot1 && progressOrNot2))) {
                                curTrackRow.children[0].children[0].style.background = 'url(\'data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff'
                                document.querySelector('.footer_play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat, #fff"
                                document.querySelector('.popup_player_content .play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%23000%22%20width%3D%2248%22%20height%3D%2248%22%20viewBox%3D%220%200%2048%2048%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20id%3D%22id-play_48__Page-2%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22id-play_48__play_48%22%3E%3Cpath%20id%3D%22id-play_48__Rectangle-737%22%20d%3D%22M0%200h48v48H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M14.4%208.76l24.02%2013.85a1.6%201.6%200%20010%202.78L14.4%2039.24a1.6%201.6%200%2001-2.4-1.39v-27.7a1.6%201.6%200%20012.4-1.39z%22%20id%3D%22id-play_48__Mask%22%20fill%3D%22currentColor%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 48px no-repeat"
                                audio.pause()
                                playing = 0
                                playingFirst = 1
                                console.log(playingFirst)
                            } else {
                                curTrackRow.children[0].children[0].style.background = 'url(\'data:image/svg+xml;charset=utf-8,%0A%3Csvg%20%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.71%205c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H6.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13zm8%200c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H14.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff'
                                document.querySelector('.footer_play').style.background = "url(\'data:image/svg+xml;charset=utf-8,%0A%3Csvg%20%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.71%205c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H6.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13zm8%200c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H14.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff"
                                document.querySelector('.popup_player_content .play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%23000%22%20height%3D%2248%22%20viewBox%3D%220%200%2048%2048%22%20width%3D%2248%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h48v48H0z%22%20opacity%3D%22.4%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M17.15%206c1.34%200%201.83.14%202.32.4.48.26.87.65%201.13%201.13.26.5.4.98.4%202.32v28.3c0%201.34-.14%201.83-.4%202.32-.26.48-.65.87-1.13%201.13-.5.26-.98.4-2.32.4h-5.3c-1.34%200-1.83-.14-2.32-.4a2.73%202.73%200%2001-1.13-1.13c-.26-.5-.4-.98-.4-2.32V9.85c0-1.34.14-1.83.4-2.32.26-.48.65-.87%201.13-1.13.5-.26.98-.4%202.32-.4zm19%200c1.34%200%201.83.14%202.32.4.48.26.87.65%201.13%201.13.26.5.4.98.4%202.32v28.3c0%201.34-.14%201.83-.4%202.32-.26.48-.65.87-1.13%201.13-.5.26-.98.4-2.32.4h-5.3c-1.34%200-1.83-.14-2.32-.4a2.73%202.73%200%2001-1.13-1.13c-.26-.5-.4-.98-.4-2.32V9.85c0-1.34.14-1.83.4-2.32.26-.48.65-.87%201.13-1.13.5-.26.98-.4%202.32-.4z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 48px no-repeat"
                                audio.play()
                                playing = 1
                            }
                        } else {
                            myObj.forEach((el, i) => {
                                document.querySelectorAll('.audio')[i].querySelector('.duration').innerText = `${secToMin(el.duration)}`
                            })
                            if (localStorage.getItem('volume')) {
                                curTrackRow.querySelectorAll('.volume_transition').forEach((el) => el.style.left = localStorage.getItem('volume') * 100 + '%')
                                curTrackRow.querySelectorAll('.volume_value').forEach((el) => el.style.width = localStorage.getItem('volume') * 100 + '%')
                            } else {
                                curTrackRow.querySelectorAll('.volume_transition').forEach((el) => el.style.left = 75 + '%')
                                curTrackRow.querySelectorAll('.volume_value').forEach((el) => el.style.width = 75 + '%')
                            }
                            playing = 1
                            document.querySelector('.footer_player_wrapper').style.display = 'block'
                            curTrackRow.querySelector('.progress_seek').style.backgroundImage = /*#b8c7d7*/ 'url("https://st1-91.vk.com/images/audio_progress.png")'//linear-gradient(45deg,rgba(255,255,255,.55) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.55) 50%,rgba(255,255,255,.55) 75%,transparent 75%,transparent)'
                            //curTrackRow.querySelector('.progress_seek').style.backgroundSize = '1rem 1rem'
                            curTrackRow.querySelector('.progress_seek').classList.add('podgruzka')
                            document.querySelector('.popup_player_content .progress_seek').style.backgroundImage = 'url("https://st1-91.vk.com/images/audio_progress.png")'//'#b8c7d7 linear-gradient(45deg,rgba(255,255,255,.55) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.55) 50%,rgba(255,255,255,.55) 75%,transparent 75%,transparent)'
                            //document.querySelector('.popup_player_content .progress_seek').style.backgroundSize = '1rem 1rem'
                            document.querySelector('.popup_player_content .progress_seek').classList.add('podgruzka')
                            curTrackRow.children[0].children[0].style.background = 'url(\'data:image/svg+xml;charset=utf-8,%0A%3Csvg%20%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.71%205c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H6.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13zm8%200c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H14.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff'
                            let hls = new Hls();
                            playing = 1
                            document.querySelector('.popup_player_content .play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%23000%22%20height%3D%2248%22%20viewBox%3D%220%200%2048%2048%22%20width%3D%2248%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h48v48H0z%22%20opacity%3D%22.4%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M17.15%206c1.34%200%201.83.14%202.32.4.48.26.87.65%201.13%201.13.26.5.4.98.4%202.32v28.3c0%201.34-.14%201.83-.4%202.32-.26.48-.65.87-1.13%201.13-.5.26-.98.4-2.32.4h-5.3c-1.34%200-1.83-.14-2.32-.4a2.73%202.73%200%2001-1.13-1.13c-.26-.5-.4-.98-.4-2.32V9.85c0-1.34.14-1.83.4-2.32.26-.48.65-.87%201.13-1.13.5-.26.98-.4%202.32-.4zm19%200c1.34%200%201.83.14%202.32.4.48.26.87.65%201.13%201.13.26.5.4.98.4%202.32v28.3c0%201.34-.14%201.83-.4%202.32-.26.48-.65.87-1.13%201.13-.5.26-.98.4-2.32.4h-5.3c-1.34%200-1.83-.14-2.32-.4a2.73%202.73%200%2001-1.13-1.13c-.26-.5-.4-.98-.4-2.32V9.85c0-1.34.14-1.83.4-2.32.26-.48.65-.87%201.13-1.13.5-.26.98-.4%202.32-.4z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 48px no-repeat"
                            document.querySelectorAll('.progress_played').forEach((el) => {
                                el.style.width = 0
                            })
                            document.querySelectorAll('.progress_transition').forEach((el) => {
                                el.style.left = 0
                            })
                            document.querySelectorAll('.progress_buffered').forEach((el) => {
                                el.style.width = 0
                            })
                            document.querySelectorAll('.audio .author').forEach((el) => {
                                el.style.display = 'block'
                            })
                            document.querySelectorAll('.audio .author_rightfromtitle').forEach((el) => {
                                el.style.display = 'none'
                            })
                            document.querySelectorAll('.player_wrapper').forEach((el) => {
                                el.style.display = 'none'
                            })
                            document.querySelectorAll('.audio .play').forEach((el) => {
                                el.style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat, #fff"
                            })
                            document.querySelector('.footer_play').style.background = "url(\'data:image/svg+xml;charset=utf-8,%0A%3Csvg%20%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.71%205c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H6.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13zm8%200c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H14.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff"
                            curTrackRow.children[0].children[0].style.background = 'url(\'data:image/svg+xml;charset=utf-8,%0A%3Csvg%20%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.71%205c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H6.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13zm8%200c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H14.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff'
                            clearInterval(intCurTime)
                            // hls.loadSource(curTrackRow.querySelector('.src_track').innerText);
                            // hls.attachMedia(audio);


                            if (Hls.isSupported()) {
                                hls.loadSource(curTrackRow.querySelector('.src_track').innerText);
                                hls.attachMedia(audio);
                            } else if (audio.canPlayType('application/vnd.apple.mpegurl')) {
                                video.src = curTrackRow.querySelector('.src_track').innerText;
                                audio = video;
                                hls.loadSource(curTrackRow.querySelector('.src_track').innerText);
                                hls.attachMedia(audio);
                                curTrackRow.querySelector('.volume_wrap').style.display = 'none';
                            }


                            hls.on(Hls.Events.MANIFEST_LOADED, function (event, data) {
                                console.log(
                                    'manifest loaded, found ' + data.levels.length + ' quality level'
                                );
                                if (data.levels.length > num_data_levels) {
                                    localStorage.getItem('volume') ? hls.media.volume = localStorage.getItem('volume') : hls.media.volume = 0.75
                                    if (playingFirst == 0) {
                                        audio.play()
                                    }
                                }
                            })
                            if (ifIntervalOne == 0) {
                                ifIntervalOne = 1
                                intCurTime2 = setInterval(() => {
                                    localStorage.setItem('curTime', hls.media.currentTime)
                                    localStorage.setItem('duration', hls.media.duration)
                                    localStorage.setItem('volume', hls.media.volume)
                                }, 5000)
                            }
                            curTrackRow.querySelectorAll('.audio .author').forEach((el) => {
                                el.style.display = 'none'
                            })
                            curTrackRow.querySelectorAll('.audio .author_rightfromtitle').forEach((el) => {
                                el.style.display = 'inline-block'
                            })
                            curTrack = curTrackRow.innerText
                            curTrackId = curTrackRow.querySelector('.id_track').innerText
                            localStorage.setItem('curTrack', JSON.stringify(myObj.filter((el) => el.id == curTrackId)[0]))
                            audio.title = JSON.parse(localStorage.getItem('curTrack')).title
                            curTrackRow.querySelector('.player_wrapper').style.display = 'flex'
                            document.querySelector('.footer_player .audio_title').textContent = curTrackRow.querySelector('.audio .info').innerText.split(' - ')[0]
                            document.querySelector('.footer_player .audio_author').textContent = curTrackRow.querySelector('.audio .info').innerText.split(' - ')[1]
                            document.querySelector('.popup_player_content .title').textContent = curTrackRow.querySelector('.audio .info').innerText.split(' - ')[0]
                            document.querySelector('.popup_player_content .author').textContent = curTrackRow.querySelector('.audio .info').innerText.split(' - ')[1]
                            document.querySelector('.popup_player_content .cover').style.backgroundImage = curTrackRow.querySelector('.audio .cover').style.backgroundImage
                            document.querySelector('.popup_player_content .duration_end').textContent = '-' + curTrackRow.querySelector('.duration').innerText
                            console.log(curTrack)

                            curTrackFromLocalStorage = JSON.parse(localStorage.getItem('curTrack'))
                            navigator.mediaSession.metadata = new MediaMetadata({
                                title: curTrackFromLocalStorage.title,
                                artist: curTrackFromLocalStorage.artist,
                                artwork: [
                                    {
                                        src: curTrackFromLocalStorage.album.thumb.photo_68,
                                        sizes: '68x68',
                                        type: 'image/png'
                                    }
                                ]
                            })

                            const actionHandlers = [
                                ['play', () => {
                                    curTrackRow.children[0].children[0].style.background = 'url(\'data:image/svg+xml;charset=utf-8,%0A%3Csvg%20%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.71%205c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H6.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13zm8%200c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H14.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff'
                                    document.querySelector('.footer_play').style.background = "url(\'data:image/svg+xml;charset=utf-8,%0A%3Csvg%20%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.71%205c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H6.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13zm8%200c.45%200%20.61.05.78.13.16.1.29.22.38.38.08.17.13.33.13.78V17.7c0%20.45-.05.61-.13.78a.91.91%200%2001-.38.38c-.17.08-.33.13-.78.13H14.8c-.45%200-.61-.05-.78-.13a.91.91%200%2001-.38-.38c-.08-.17-.13-.33-.13-.78V6.3c0-.45.05-.61.13-.78.1-.16.22-.29.38-.38.17-.08.33-.13.78-.13z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff"
                                    document.querySelector('.popup_player_content .play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%23000%22%20height%3D%2248%22%20viewBox%3D%220%200%2048%2048%22%20width%3D%2248%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h48v48H0z%22%20opacity%3D%22.4%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M17.15%206c1.34%200%201.83.14%202.32.4.48.26.87.65%201.13%201.13.26.5.4.98.4%202.32v28.3c0%201.34-.14%201.83-.4%202.32-.26.48-.65.87-1.13%201.13-.5.26-.98.4-2.32.4h-5.3c-1.34%200-1.83-.14-2.32-.4a2.73%202.73%200%2001-1.13-1.13c-.26-.5-.4-.98-.4-2.32V9.85c0-1.34.14-1.83.4-2.32.26-.48.65-.87%201.13-1.13.5-.26.98-.4%202.32-.4zm19%200c1.34%200%201.83.14%202.32.4.48.26.87.65%201.13%201.13.26.5.4.98.4%202.32v28.3c0%201.34-.14%201.83-.4%202.32-.26.48-.65.87-1.13%201.13-.5.26-.98.4-2.32.4h-5.3c-1.34%200-1.83-.14-2.32-.4a2.73%202.73%200%2001-1.13-1.13c-.26-.5-.4-.98-.4-2.32V9.85c0-1.34.14-1.83.4-2.32.26-.48.65-.87%201.13-1.13.5-.26.98-.4%202.32-.4z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 48px no-repeat"
                                    audio.play()
                                    playing = 1
                                }],
                                ['pause', () => {
                                    curTrackRow.children[0].children[0].style.background = 'url(\'data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff'
                                    document.querySelector('.footer_play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat, #fff"
                                    document.querySelector('.popup_player_content .play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%23000%22%20width%3D%2248%22%20height%3D%2248%22%20viewBox%3D%220%200%2048%2048%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20id%3D%22id-play_48__Page-2%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22id-play_48__play_48%22%3E%3Cpath%20id%3D%22id-play_48__Rectangle-737%22%20d%3D%22M0%200h48v48H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M14.4%208.76l24.02%2013.85a1.6%201.6%200%20010%202.78L14.4%2039.24a1.6%201.6%200%2001-2.4-1.39v-27.7a1.6%201.6%200%20012.4-1.39z%22%20id%3D%22id-play_48__Mask%22%20fill%3D%22currentColor%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 48px no-repeat"
                                    audio.pause()
                                    playing = 0
                                }],
                                ['seekto', (details) => {
                                    hls.media.currentTime = details.seekTime
                                }],
                                ['previoustrack', () => {
                                    playing = 0
                                    if (shuffle == 1) {
                                        document.querySelectorAll('.audio')[Math.floor(Math.random() * document.querySelectorAll('.audio').length)].children[0].click()
                                    } else {
                                        if (curTrackRow.previousSibling.previousSibling)
                                            curTrackRow.previousSibling.previousSibling.children[0].click()
                                        else {
                                            document.querySelectorAll('.audio')[document.querySelectorAll('.audio').length - 1].children[0].click()
                                        }
                                    }
                                    document.querySelector('.popup_player_content .progress_transition_circle').style.left = '0%'
                                    document.querySelector('.popup_player_content .duration_start').textContent = '0:00'
                                }],
                                ['nexttrack', () => {
                                    playing = 0
                                    if (shuffle == 1) {
                                        document.querySelectorAll('.audio')[Math.floor(Math.random() * document.querySelectorAll('.audio').length)].children[0].click()
                                    } else {
                                        if (curTrackRow.nextSibling.nextSibling)
                                            curTrackRow.nextSibling.nextSibling.children[0].click()
                                        else {
                                            document.querySelectorAll('.audio')[0].children[0].click()
                                        }
                                    }
                                    document.querySelector('.popup_player_content .progress_transition_circle').style.left = '0%'
                                    document.querySelector('.popup_player_content .duration_start').textContent = '0:00'
                                }],
                                ['seekbackward', () => {
                                    if (hls.media.currentTime - 10 > 0)
                                        hls.media.currentTime -= 10
                                }],
                                ['seekforward', () => {
                                    if (hls.media.currentTime + 10 < hls.media.duration)
                                        hls.media.currentTime += 10
                                }]/*,
                                ['stop', () => {
                                    hls.media.currentTime = 0
                                    audio.pause()
                                }],*/
                            ];

                            for (const [action, handler] of actionHandlers) {
                                try {
                                    navigator.mediaSession.setActionHandler(action, handler);
                                } catch (error) {
                                    console.log(`The media session action "${action}" is not supported yet.`);
                                }
                            }

                            /*function updatePositionState() {
                                navigator.mediaSession.playbackState = hls.media.paused ? 'paused' : 'playing'
                                navigator.mediaSession.setPositionState({
                                    duration: hls.media.duration,
                                    playbackRate: hls.media.playbackRate,
                                    position: hls.media.currentTime,
                                });

                            }

                            if ('mediaSession' in navigator) {
                                const events = ['paused', 'playing', 'durationchange', 'ratechange', 'timechange']
                                for (const event of events) {
                                    audio.addEventListener(event, updatePositionState)
                                }
                            }*/

                            let inProgressBar1 = 0
                            let inProgressBar2 = 0
                            let inProgressBar3 = 0
                            let dragProgress1 = (e) => {
                                console.log(e)
                                let r = Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * hls.media.duration)
                                hls.media.currentTime = r
                            }
                            let dragProgress2 = (e) => {
                                console.log(e)
                                let r = Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * hls.media.duration)
                                hls.media.currentTime = r
                            }
                            let dragProgress3 = (e) => {
                                console.log(e)
                                let r = (e.clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                                if (r < 0)
                                    hls.media.volume = 0
                                else if (r > 1)
                                    hls.media.volume = 1
                                else {
                                    hls.media.volume = r
                                }
                            }
                            let dragProgressTouch1 = (e) => {
                                console.log(e)
                                let r = Math.floor((e.changedTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * hls.media.duration)
                                hls.media.currentTime = r
                            }
                            let dragProgressTouch2 = (e) => {
                                console.log(e)
                                let r = Math.floor((e.changedTouches[0].clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * hls.media.duration)
                                hls.media.currentTime = r
                            }
                            let dragProgressTouch3 = (e) => {
                                console.log(e)
                                let r = (e.changedTouches[0].clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                                if (r < 0)
                                    hls.media.volume = 0
                                else if (r > 1)
                                    hls.media.volume = 1
                                else {
                                    hls.media.volume = r
                                }
                            }
                            curTrackRow.querySelector('.progress_wrap').addEventListener('mousedown', (e) => {
                                if (hls.media.duration) {
                                    inProgressBar1 = 1
                                    console.log(Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%')
                                    if (Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) <= 100) {
                                        curTrackRow.querySelector('.progress_transition').style.left = Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%'
                                        curTrackRow.querySelector('.progress_played').style.width = Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%'
                                    }
                                    progressOrNot1 = 1
                                }
                            })
                            window.addEventListener('touchstart', (e) => {
                                if (hls.media.duration && e.composedPath().includes(curTrackRow.querySelector('.progress_wrap'))) {
                                    inProgressBar1 = 1
                                    console.log(Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%')
                                    if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) <= 100) {
                                        curTrackRow.querySelector('.progress_transition').style.left = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%'
                                        curTrackRow.querySelector('.progress_played').style.width = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%'
                                    }
                                    progressOrNot1 = 1
                                    //console.log(e, + curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x + '  /  ' + curTrackRow.querySelector('.progress_seek').offsetWidth * 100)
                                }
                                if (e.composedPath().includes(curTrackRow.querySelector('.volume_wrap'))) {
                                    inProgressBar3 = 1
                                    document.querySelectorAll('.volume_value').forEach((el) => {
                                        if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                            el.style.width = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                                    })
                                    document.querySelectorAll('.volume_transition').forEach((el) => {
                                        if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                            el.style.left = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                                    })
                                    progressOrNot1 = 1
                                    let r = (e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                                    localStorage.setItem('volume', r)
                                    if (r < 0)
                                        hls.media.volume = 0
                                    else if (r > 1)
                                        hls.media.volume = 1
                                    else {
                                        hls.media.volume = r
                                    }
                                }
                                if (hls.media.duration && e.composedPath().includes(document.querySelector('.popup_player_content .progress_wrap'))) {
                                    inProgressBar2 = 1
                                    if (Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) <= 100) {
                                        document.querySelector('.popup_player_content .progress_transition_circle').style.left = (e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * 100 + '%'
                                        document.querySelector('.popup_player_content .progress_played').style.width = (e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * 100 + '%'
                                    }
                                    progressOrNot1 = 1
                                }
                            })
                            document.querySelector('.popup_player_content .progress_wrap').addEventListener('mousedown', (e) => {
                                if (hls.media.duration) {
                                    inProgressBar2 = 1
                                    if (Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) <= 100) {
                                        document.querySelector('.popup_player_content .progress_transition_circle').style.left = (e.clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * 100 + '%'
                                        document.querySelector('.popup_player_content .progress_played').style.width = (e.clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * 100 + '%'
                                    }
                                    progressOrNot1 = 1
                                }
                            })
                            curTrackRow.querySelector('.volume_wrap').addEventListener('mousedown', (e) => {
                                inProgressBar3 = 1
                                document.querySelectorAll('.volume_value').forEach((el) => {
                                    if (Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                        el.style.width = Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                                })
                                document.querySelectorAll('.volume_transition').forEach((el) => {
                                    if (Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                        el.style.left = Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                                })
                                progressOrNot1 = 1
                                let r = (e.clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                                localStorage.setItem('volume', r)
                                if (r < 0)
                                    hls.media.volume = 0
                                else if (r > 1)
                                    hls.media.volume = 1
                                else {
                                    hls.media.volume = r
                                }
                            })
                            window.addEventListener('touchmove', (e) => {
                                if (inProgressBar1 == 1) {
                                    if (hls.media.duration) {
                                        console.log(Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%')
                                        if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) <= 100) {
                                            curTrackRow.querySelector('.progress_transition').style.left = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%'
                                            curTrackRow.querySelector('.progress_played').style.width = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%'
                                            if (hls.media.currentTime)
                                                curTrackRow.querySelector('.duration').textContent = `${secToMin(Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * hls.media.duration))}`
                                        }
                                        console.log(Math.floor(hls.media.duration - (e.targetTouches[0].clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * hls.media.duration))
                                    }
                                }
                                if (inProgressBar2 == 1) {
                                    if (hls.media.duration) {
                                        if (Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) <= 100) {
                                            document.querySelector('.popup_player_content .progress_transition_circle').style.left = (e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * 100 + '%'
                                            document.querySelector('.popup_player_content .progress_played').style.width = (e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * 100 + '%'
                                            if (hls.media.currentTime) {
                                                document.querySelector('.popup_player_content .duration_end').textContent = `-${secToMin(1 + hls.media.duration - Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * hls.media.duration))}`
                                                document.querySelector('.popup_player_content .duration_start').textContent = `${secToMin(Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * hls.media.duration))}`
                                            }
                                        }
                                        if (Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) <= 100) {
                                            curTrackRow.querySelector('.progress_transition').style.left = Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) + '%'
                                            curTrackRow.querySelector('.progress_played').style.width = Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) + '%'
                                            if (hls.media.currentTime)
                                                curTrackRow.querySelector('.duration').textContent = `${secToMin(Math.floor((e.targetTouches[0].clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * hls.media.duration))}`
                                        }
                                    }
                                }
                                if (inProgressBar3 == 1) {
                                    document.querySelectorAll('.volume_value').forEach((el) => {
                                        if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                            el.style.width = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                                    })
                                    document.querySelectorAll('.volume_transition').forEach((el) => {
                                        if (Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                            el.style.left = Math.floor((e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                                    })
                                    let r = (e.targetTouches[0].clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                                    if (r < 0) {
                                        hls.media.volume = 0
                                        localStorage.setItem('volume', 0)
                                    } else if (r > 1) {
                                        hls.media.volume = 1
                                        localStorage.setItem('volume', 1)
                                    } else {
                                        hls.media.volume = r
                                        localStorage.setItem('volume', r)
                                    }
                                }
                            })
                            window.addEventListener('mousemove', (e) => {
                                if (inProgressBar1 == 1) {
                                    if (hls.media.duration) {
                                        console.log(Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%')
                                        if (Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) <= 100) {
                                            curTrackRow.querySelector('.progress_transition').style.left = Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%'
                                            curTrackRow.querySelector('.progress_played').style.width = Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * 100) + '%'
                                            if (hls.media.currentTime)
                                                curTrackRow.querySelector('.duration').textContent = `${secToMin(Math.floor((e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * hls.media.duration))}`
                                        }
                                        console.log(Math.floor(hls.media.duration - (e.clientX - curTrackRow.querySelector('.progress_seek').getBoundingClientRect().x) / curTrackRow.querySelector('.progress_seek').offsetWidth * hls.media.duration))
                                    }
                                }
                                if (inProgressBar2 == 1) {
                                    if (hls.media.duration) {
                                        if (Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) <= 100) {
                                            document.querySelector('.popup_player_content .progress_transition_circle').style.left = (e.clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * 100 + '%'
                                            document.querySelector('.popup_player_content .progress_played').style.width = (e.clientX - document.querySelector('.popup_player_content .progress_wrap').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_wrap').offsetWidth * 100 + '%'
                                            if (hls.media.currentTime) {
                                                document.querySelector('.popup_player_content .duration_end').textContent = `-${secToMin(1 + hls.media.duration - Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * hls.media.duration))}`
                                                document.querySelector('.popup_player_content .duration_start').textContent = `${secToMin(Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * hls.media.duration))}`
                                            }
                                        }
                                        if (Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) >= 0 && Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) <= 100) {
                                            curTrackRow.querySelector('.progress_transition').style.left = Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) + '%'
                                            curTrackRow.querySelector('.progress_played').style.width = Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * 100) + '%'
                                            if (hls.media.currentTime)
                                                curTrackRow.querySelector('.duration').textContent = `${secToMin(Math.floor((e.clientX - document.querySelector('.popup_player_content .progress_seek').getBoundingClientRect().x) / document.querySelector('.popup_player_content .progress_seek').offsetWidth * hls.media.duration))}`
                                        }
                                    }
                                }
                                if (inProgressBar3 == 1) {
                                    document.querySelectorAll('.volume_value').forEach((el) => {
                                        if (Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                            el.style.width = Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                                    })
                                    document.querySelectorAll('.volume_transition').forEach((el) => {
                                        if (Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) >= 0 && Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) <= 100)
                                            el.style.left = Math.floor((e.clientX - curTrackRow.querySelector('.volume_wrap').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_wrap').offsetWidth * 100) + '%'
                                    })
                                    let r = (e.clientX - curTrackRow.querySelector('.volume_display').getBoundingClientRect().x) / curTrackRow.querySelector('.volume_display').offsetWidth
                                    if (r < 0) {
                                        hls.media.volume = 0
                                        localStorage.setItem('volume', 0)
                                    } else if (r > 1) {
                                        hls.media.volume = 1
                                        localStorage.setItem('volume', 1)
                                    } else {
                                        hls.media.volume = r
                                        localStorage.setItem('volume', r)
                                    }
                                }
                            })
                            window.addEventListener('mouseup', (e) => {

                                console.log('beg')
                                if (inProgressBar1 == 1) {
                                    dragProgress1(e)
                                }
                                if (inProgressBar2 == 1) {
                                    dragProgress2(e)
                                }
                                if (inProgressBar3 == 1) {
                                    dragProgress3(e)
                                }
                                inProgressBar1 = 0
                                inProgressBar2 = 0
                                inProgressBar3 = 0
                                console.log('0 0')
                            })
                            window.addEventListener('touchend', (e) => {
                                if (e.composedPath().includes(curTrackRow.querySelector('.volume_wrap'))||e.composedPath().includes(curTrackRow.querySelector('.progress_wrap'))) {
                                    console.log(e)
                                    console.log('beg')
                                    if (inProgressBar1 == 1) {
                                        dragProgressTouch1(e)
                                    }
                                    if (inProgressBar2 == 1) {
                                        dragProgressTouch2(e)
                                    }
                                    if (inProgressBar3 == 1) {
                                        dragProgressTouch3(e)
                                    }
                                    inProgressBar1 = 0
                                    inProgressBar2 = 0
                                    inProgressBar3 = 0
                                    console.log('0 0')
                                }
                            })
                            let ghj = 0
                            let falgEnded = 0
                            setTimeout(()=>{falgEnded = 1}, 1000)
                            hls.media.onended = () => {
                                if(falgEnded){
                                    console.log('END---------------------------')
                                    //document.querySelector('.wrapper').click()
                                    clearInterval(intCurTime)
                                    document.querySelector('.popup_player_content .duration_start').textContent = '0:00'
                                    document.querySelectorAll('.progress_played').forEach((el) => {
                                        el.style.width = 0
                                    })
                                    document.querySelectorAll('.progress_transition').forEach((el) => {
                                        el.style.left = 0
                                    })
                                    document.querySelector('.progress_transition_circle').style.left = 0
                                    document.querySelector('.duration_start').innerText = '0:00'
                                    document.querySelectorAll('.progress_buffered').forEach((el) => {
                                        el.style.width = 0
                                    })
                                    document.querySelectorAll('.audio .author').forEach((el) => {
                                        el.style.display = 'block'
                                    })
                                    document.querySelectorAll('.audio .author_rightfromtitle').forEach((el) => {
                                        el.style.display = 'none'
                                    })
                                    document.querySelectorAll('.player_wrapper').forEach((el) => {
                                        el.style.display = 'none'
                                    })
                                    document.querySelectorAll('.audio .play').forEach((el) => {
                                        el.style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat, #fff"
                                    })
                                    document.querySelector('.popup_player_content .play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%23000%22%20width%3D%2248%22%20height%3D%2248%22%20viewBox%3D%220%200%2048%2048%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20id%3D%22id-play_48__Page-2%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22id-play_48__play_48%22%3E%3Cpath%20id%3D%22id-play_48__Rectangle-737%22%20d%3D%22M0%200h48v48H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M14.4%208.76l24.02%2013.85a1.6%201.6%200%20010%202.78L14.4%2039.24a1.6%201.6%200%2001-2.4-1.39v-27.7a1.6%201.6%200%20012.4-1.39z%22%20id%3D%22id-play_48__Mask%22%20fill%3D%22currentColor%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 48px no-repeat"
                                    document.querySelector('.footer_play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat, #fff"
                                    if (shuffle == 1) {
                                        document.querySelectorAll('.audio')[Math.floor(Math.random() * document.querySelectorAll('.audio').length)].children[0].click()
                                    } else {
                                        if (repeat == 1) {
                                            if (curTrackRow.nextSibling.nextSibling)
                                                curTrackRow.nextSibling.nextSibling.children[0].click()
                                            else {
                                                document.querySelector('.audios').children[0].children[0].click()
                                            }
                                        } else {
                                            if (repeat == 2) {
                                                curTrackRow.children[0].click()
                                            } else {
                                                console.log('click to next')
                                                if (curTrackRow.nextSibling.nextSibling)
                                                    curTrackRow.nextSibling.nextSibling.children[0].click()
                                                else {
                                                    localStorage.setItem('curTrack', JSON.stringify(myObj[0]))
                                                    curTrackRow = document.querySelector('.audios').children[0]
                                                    let inputDataTrack = JSON.parse(localStorage.getItem('curTrack'))
                                                    document.querySelector('.footer_player .audio_title').textContent = inputDataTrack.title
                                                    document.querySelector('.footer_player .audio_author').textContent = inputDataTrack.artist
                                                    document.querySelector('.popup_player_content .title').textContent = inputDataTrack.title
                                                    document.querySelector('.popup_player_content .author').textContent = inputDataTrack.artist
                                                    document.querySelector('.popup_player_content .cover').style.background = `url('${inputDataTrack.album.thumb.photo_68}') center / cover no-repeat`
                                                    document.querySelector('.popup_player_content .duration_end').textContent = secToMin(Math.floor(inputDataTrack.duration - hls.media.currentTime))
                                                    console.log(curTrackRow)
                                                    hls.media.currentTime = 0
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            intCurTime = setInterval(() => {
                                if (!hls.media.paused) {
                                    if (ghj == 0) {
                                        //document.querySelector('.audios').insertBefore(document.createElement('button'), curTrackRow)
                                        ghj++
                                    }
                                    if (secToMin(hls.media.duration - Math.floor(hls.media.currentTime))) {
                                        if (!inProgressBar1 && !inProgressBar2 && hls.media.currentTime && hls.media.duration) document.querySelector('.popup_player_content .duration_end').textContent = `-${secToMin(hls.media.duration - Math.floor(hls.media.currentTime))}`
                                        if (!inProgressBar1 && !inProgressBar2 && hls.media.currentTime && hls.media.duration) curTrackRow.querySelector('.duration').textContent = `${secToMin(Math.floor(hls.media.currentTime))}`
                                    }
                                    let lenOfBuf = hls.media.buffered.end(hls.media.buffered.length - 1)
                                    if (lenOfBuf > 0) {
                                        curTrackRow.querySelector('.progress_seek').style.background = '#ebedf0'
                                        document.querySelector('.popup_player_content .progress_seek').style.background = '#ebedf0'
                                        /*navigator.mediaSession.setPositionState({
                                            duration: hls.media.duration,
                                            playbackRate: hls.media.playbackRate,
                                            position: 0
                                        });*/
                                        //console.log(navigator.mediaSession)//.positionState)
                                    }
                                    if (!inProgressBar1 && !inProgressBar2) curTrackRow.querySelector('.progress_played').style.width = hls.media.currentTime / hls.media.duration * 100 + '%'
                                    if (!inProgressBar1 && !inProgressBar2) curTrackRow.querySelector('.progress_transition').style.left = hls.media.currentTime / hls.media.duration * 100 + '%'
                                    if (!inProgressBar3 && hls.media.volume) document.querySelectorAll('.volume_value').forEach((el) => el.style.width = hls.media.volume * 100 + '%')
                                    if (!inProgressBar3 && hls.media.volume) document.querySelectorAll('.volume_transition').forEach((el) => el.style.left = hls.media.volume * 100 + '%')
                                    if (!inProgressBar2) document.querySelector('.popup_player_content .progress_played').style.width = hls.media.currentTime / hls.media.duration * 100 + '%'
                                    if (!inProgressBar2) document.querySelector('.popup_player_content .progress_transition_circle').style.left = hls.media.currentTime / hls.media.duration * 100 + '%'
                                    curTrackRow.querySelector('.progress_buffered').style.width = lenOfBuf / hls.media.duration * 100 + '%'
                                    document.querySelector('.popup_player_content .progress_buffered').style.width = lenOfBuf / hls.media.duration * 100 + '%'
                                    let curFormatTime
                                    parseInt(hls.media.currentTime / 60) > 9 ? curFormatTime = parseInt(hls.media.currentTime / 60) + ':' : curFormatTime = parseInt(hls.media.currentTime / 60) + ':'
                                    parseInt(hls.media.currentTime % 60) > 9 ? curFormatTime += parseInt(hls.media.currentTime % 60) : curFormatTime += '0' + parseInt(hls.media.currentTime % 60)
                                    if (!inProgressBar2) document.querySelector('.popup_player_content .duration_start').textContent = curFormatTime
                                } else {
                                    /*if (document.querySelector('audio').duration == document.querySelector('audio').currentTime)
                                        curTrackRow.nextSibling.nextSibling.children[0].click()*/
                                    let lenOfBuf = hls.media.buffered.end(hls.media.buffered.length - 1)
                                    if (lenOfBuf > 0) {
                                        curTrackRow.querySelector('.progress_seek').style.background = '#ebedf0'
                                        document.querySelector('.popup_player_content .progress_seek').style.background = '#ebedf0'
                                    }
                                    curTrackRow.querySelector('.progress_buffered').style.width = lenOfBuf / hls.media.duration * 100 + '%'
                                    document.querySelector('.popup_player_content .progress_buffered').style.width = lenOfBuf / hls.media.duration * 100 + '%'
                                }
                            }, 100)
                        }
                    }
                }
            })
        }
    }

    document.querySelector('.footer_play').onclick = () => {
        curTrackRow.children[0].click()
        console.log('fasf')
    }

    document.querySelector('.footer_close').onclick = () => {
        audio.pause()
        localStorage.setItem('curTrack', '')
        localStorage.setItem('duration', '')
        localStorage.setItem('curTime', '0')
        document.querySelectorAll('.progress_played').forEach((el) => {
            el.style.width = 0
        })
        document.querySelectorAll('.progress_transition').forEach((el) => {
            el.style.left = 0
        })
        document.querySelector('.progress_transition_circle').style.left = 0
        document.querySelector('.popup_player_content .duration_start').innerText = ''
        document.querySelector('.popup_player_content .duration_end').innerText = ''
        document.querySelector('.popup_player_content .cover').style.background = ''
        document.querySelector('.popup_player_content .title').innerText = ''
        document.querySelector('.popup_player_content .author').innerText = ''
        document.querySelector('.footer_player_wrapper').style.display = 'none'
        curTrackRow.querySelector('.player_wrapper').style.display = 'none'
        curTrackRow.querySelector('.author_rightfromtitle').style.display = 'none'
        curTrackRow.querySelectorAll('.author')[1].style.display = 'block'
        curTrackRow.querySelectorAll('.progress_buffered').forEach((el) => {
            el.style.width = 0
        })
        curTrackRow.children[0].children[0].style.background = 'url(\'data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E\') center / 24px no-repeat, #fff'
        document.querySelector('.footer_play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%233f8ae0%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M8.13%205.1l10.5%206.25a.75.75%200%20010%201.29l-10.5%206.25A.75.75%200%20017%2018.25V5.75a.75.75%200%20011.13-.64z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat, #fff"
        document.querySelector('.popup_player_content .play').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%20%23000%22%20width%3D%2248%22%20height%3D%2248%22%20viewBox%3D%220%200%2048%2048%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20id%3D%22id-play_48__Page-2%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22id-play_48__play_48%22%3E%3Cpath%20id%3D%22id-play_48__Rectangle-737%22%20d%3D%22M0%200h48v48H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M14.4%208.76l24.02%2013.85a1.6%201.6%200%20010%202.78L14.4%2039.24a1.6%201.6%200%2001-2.4-1.39v-27.7a1.6%201.6%200%20012.4-1.39z%22%20id%3D%22id-play_48__Mask%22%20fill%3D%22currentColor%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 48px no-repeat"
        playing = 0
        curTrack = ''
        clearInterval(intCurTime)
        clearInterval(intCurTime2)
    }

    document.querySelector('.footer_player').onclick = (e) => {
        const withinBoundaries1 = e.composedPath().includes(document.querySelector('.footer_play'));
        const withinBoundaries2 = e.composedPath().includes(document.querySelector('.footer_close'));
        if (!withinBoundaries1 && !withinBoundaries2) {
            document.querySelector('.popup_player_wrapper').style.display = 'block'
            document.querySelector('.popup_player_wrapper').onclick = (e) => {
                const withinBoundaries = e.composedPath().includes(document.querySelector('.popup_player_content'));
                if (!withinBoundaries) {
                    document.querySelector('.popup_player_wrapper').style.display = 'none'
                }
            }
        }
    }

    document.querySelector('.buttons_wrap .prev').onclick = () => {
        playing = 0
        if (shuffle == 1) {
            document.querySelectorAll('.audio')[Math.floor(Math.random() * document.querySelectorAll('.audio').length)].children[0].click()
        } else {
            console.log(curTrackRow.previousSibling)
            if (curTrackRow.previousSibling.previousSibling)
                curTrackRow.previousSibling.previousSibling.children[0].click()
            else {
                document.querySelectorAll('.audio')[document.querySelectorAll('.audio').length - 1].children[0].click()
            }
        }
        document.querySelector('.popup_player_content .progress_transition_circle').style.left = '0%'
        document.querySelector('.popup_player_content .duration_start').textContent = '0:00'
    }

    document.querySelector('.buttons_wrap .next').onclick = () => {
        playing = 0
        if (shuffle == 1) {
            document.querySelectorAll('.audio')[Math.floor(Math.random() * document.querySelectorAll('.audio').length)].children[0].click()
        } else {
            if (curTrackRow.nextSibling.nextSibling)
                curTrackRow.nextSibling.nextSibling.children[0].click()
            else {
                document.querySelectorAll('.audio')[0].children[0].click()
            }
        }
        document.querySelector('.popup_player_content .progress_transition_circle').style.left = '0%'
        document.querySelector('.popup_player_content .duration_start').textContent = '0:00'
    }

    document.querySelector('.buttons_wrap .play').onclick = () => {
        curTrackRow.children[0].click()
    }

    document.querySelector('.shuffle').onclick = () => {
        if (shuffle == 0) {
            document.querySelector('.shuffle').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%232688eb%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M19.5%205.26a.5.5%200%2001.3.1l2.93%202.24a.5.5%200%20010%20.8l-2.92%202.23a.5.5%200%2001-.81-.4V9h-3.5c-.9%200-1.7.76-3.28%203%201.57%202.24%202.39%203%203.28%203H19v-1.23a.5.5%200%2001.8-.4l2.93%202.23a.5.5%200%20010%20.8l-2.92%202.23a.5.5%200%2001-.81-.4V17h-3.5c-1.7%200-2.75-.84-4.5-3.26C9.25%2016.16%208.2%2017%206.5%2017H4a1%201%200%20010-2h2.5c.9%200%201.7-.76%203.28-3C8.21%209.76%207.4%209%206.5%209H4a1%201%200%20110-2h2.5c1.7%200%202.75.84%204.5%203.26C12.75%207.84%2013.8%207%2015.5%207H19V5.77c0-.28.22-.5.5-.5z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
            shuffle = 1
            localStorage.setItem('shuffle', 1)
        } else {
            document.querySelector('.shuffle').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%2399a2ad%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M19.5%205.26a.5.5%200%2001.3.1l2.93%202.24a.5.5%200%20010%20.8l-2.92%202.23a.5.5%200%2001-.81-.4V9h-3.5c-.9%200-1.7.76-3.28%203%201.57%202.24%202.39%203%203.28%203H19v-1.23a.5.5%200%2001.8-.4l2.93%202.23a.5.5%200%20010%20.8l-2.92%202.23a.5.5%200%2001-.81-.4V17h-3.5c-1.7%200-2.75-.84-4.5-3.26C9.25%2016.16%208.2%2017%206.5%2017H4a1%201%200%20010-2h2.5c.9%200%201.7-.76%203.28-3C8.21%209.76%207.4%209%206.5%209H4a1%201%200%20110-2h2.5c1.7%200%202.75.84%204.5%203.26C12.75%207.84%2013.8%207%2015.5%207H19V5.77c0-.28.22-.5.5-.5z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
            shuffle = 0
            localStorage.setItem('shuffle', 0)
        }
    }

    document.querySelector('.repeat').onclick = () => {

        if (repeat == 0) {
            document.querySelector('.repeat').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%232688eb%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M20.5%2012a1%201%200%20011%201c0%203.05-1.95%205-5%205H9.02v1.75c0%20.26-.14.35-.33.24l-.06-.04-3.47-2.65c-.21-.16-.22-.43%200-.6l3.47-2.65c.2-.16.39-.08.39.2V16h7.48c1.88%200%202.92-.98%203-2.8V13a1%201%200%20011-1zm-5.1-7.95l3.46%202.65c.21.17.2.44%200%20.6l-3.47%202.65c-.21.17-.39.08-.39-.2V8H7.5c-1.88%200-2.92.98-3%202.8v.2a1%201%200%2001-2%200c0-3.05%201.95-5%205-5H15V4.25c0-.28.18-.36.4-.2z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
            repeat = 1
            localStorage.setItem('repeat', 1)
        } else if (repeat == 1) {
            document.querySelector('.repeat').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%232688eb%22%20fill%3D%22none%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22currentColor%22%3E%3Cpath%20clip-rule%3D%22evenodd%22%20d%3D%22m12.4754%209.13192c.2663.1638.4285.45396.4285.76649v4.20209c0%20.4971-.4031.9-.9003.9-.4973%200-.9004-.4029-.9004-.9v-2.7396c-.4428.2197-.9807.0412-1.20382-.4007-.22408-.4437-.04589-.98497.39802-1.20897l1.3004-.65625c.2791-.14084.6114-.12686.8776.03694z%22%20fill-rule%3D%22evenodd%22%2F%3E%3Cpath%20d%3D%22m2.00464%2012c0-3.25844%202.64246-5.89996%205.9021-5.89996h10.02596l-.5638-.56364c-.3516-.35148-.3516-.92132%200-1.2728.3516-.35147.9216-.35147%201.2732%200l2.1008%202.09998c.3516.35147.3516.92132%200%201.27279l-2.1008%202.09998c-.3516.35145-.9216.35145-1.2732%200-.3516-.35147-.3516-.92132%200-1.2728l.5637-.56351h-10.02586c-2.26517%200-4.10146%201.83563-4.10146%204.09996v.0967c0%20.4971-.40309.9-.90032.9s-.90032-.4029-.90032-.9z%22%2F%3E%3Cpath%20d%3D%22m21.1043%2011.0033c.4973%200%20.9003.403.9003.9v.0967c0%203.2585-2.6424%205.9-5.9021%205.9h-10.02836l.56372.5636c.35159.3514.35159.9213%200%201.2727-.3516.3515-.92165.3515-1.27325%200l-2.10072-2.0999c-.3516-.3515-.3516-.9213%200-1.2728l2.10072-2.1c.3516-.3515.92165-.3515%201.27325%200%20.35159.3515.35159.9213%200%201.2728l-.56384.5636h10.02848c2.2652%200%204.1015-1.8356%204.1015-4.1v-.0967c0-.497.4031-.9.9003-.9z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
            repeat = 2
            localStorage.setItem('repeat', 2)
        } else if (repeat == 2) {
            document.querySelector('.repeat').style.background = "url('data:image/svg+xml;charset=utf-8,%3Csvg%20style%3D%22color%3A%2399a2ad%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%200h24v24H0z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22M20.5%2012a1%201%200%20011%201c0%203.05-1.95%205-5%205H9.02v1.75c0%20.26-.14.35-.33.24l-.06-.04-3.47-2.65c-.21-.16-.22-.43%200-.6l3.47-2.65c.2-.16.39-.08.39.2V16h7.48c1.88%200%202.92-.98%203-2.8V13a1%201%200%20011-1zm-5.1-7.95l3.46%202.65c.21.17.2.44%200%20.6l-3.47%202.65c-.21.17-.39.08-.39-.2V8H7.5c-1.88%200-2.92.98-3%202.8v.2a1%201%200%2001-2%200c0-3.05%201.95-5%205-5H15V4.25c0-.28.18-.36.4-.2z%22%20fill%3D%22currentColor%22%20fill-rule%3D%22nonzero%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fsvg%3E') center / 24px no-repeat"
            repeat = 0
            localStorage.setItem('repeat', 0)
        }

    };
    xmlhttp.open("GET", "tracks.json", true);
    xmlhttp.send();
</script>
</body>
</html>